# Tambahkan di trade_database.py

def get_daily_stats(self, bot_id: str = None) -> dict:
    """Get today's statistics (FIXED FOR TIMEZONE)"""
    try:
        from datetime import datetime, time
        
        # âœ… Use local date
        today = datetime.now().date()
        start_ts = datetime.combine(today, time.min).timestamp()
        end_ts = datetime.combine(today, time.max).timestamp()
        
        query = """
            SELECT 
                COUNT(*) as total,
                COALESCE(SUM(CASE WHEN profit > 0 THEN 1 ELSE 0 END), 0) as wins,
                COALESCE(SUM(CASE WHEN profit < 0 THEN 1 ELSE 0 END), 0) as losses,
                COALESCE(SUM(profit), 0.0) as total_pnl
            FROM trades 
            WHERE timestamp BETWEEN ? AND ?
        """
        
        params = [start_ts, end_ts]
        
        if bot_id: 
            query += " AND bot_id = ?"
            params.append(bot_id)
        
        self.cursor.execute(query, params)
        row = self.cursor.fetchone()
        
        total = row[0]
        wins = row[1]
        
        return {
            'total_trades': total,
            'wins': wins,
            'losses':  row[2],
            'total_pnl': row[3],
            'win_rate': (wins / total * 100.0) if total > 0 else 0.0
        }
    except Exception as e: 
        print(f"get_daily_stats error: {e}")
        import traceback
        traceback.print_exc()
        return {
            'total_trades': 0,
            'wins': 0,
            'losses': 0,
            'total_pnl': 0.0,
            'win_rate': 0.0
        }